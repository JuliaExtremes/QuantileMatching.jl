<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantile matching in Julia · QuantileMatching.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>QuantileMatching.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Quantile matching in Julia</a><ul class="internal"><li><a class="tocitem" href="#Package-interface"><span>Package interface</span></a></li><li><a class="tocitem" href="#Empirical-Quantile-Matching"><span>Empirical Quantile Matching</span></a></li><li><a class="tocitem" href="#Parametric-Quantile-Matching"><span>Parametric Quantile Matching</span></a></li><li><a class="tocitem" href="#Frequency-adjustment"><span>Frequency adjustment</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../StationaryQuantileMatching/">Stationary Quantile Matching</a></li><li><a class="tocitem" href="../NonStationaryQuantileMatching/">Non- Stationary Quantile Matching</a></li><li><a class="tocitem" href="../">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quantile matching in Julia</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quantile matching in Julia</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaExtremes/QuantileMatching.jl/blob/main/docs/src/description.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quantile-matching-in-Julia"><a class="docs-heading-anchor" href="#Quantile-matching-in-Julia">Quantile matching in Julia</a><a id="Quantile-matching-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Quantile-matching-in-Julia" title="Permalink"></a></h1><p>The package provides several exhaustive high-performance functions to perform quantile matching (QM; see for example <a href="https://digital.libraries.psu.edu/digital/collection/digitalbks2/id/48274/">Panofsky and Brier, 1968</a> and <a href="https://rmets.onlinelibrary.wiley.com/doi/10.1002/joc.2168">Themeßl <em>et al.</em>, 2011</a>) of an actual distribution and a target distribution. It also provides the functions for the non-stationary case (see for example <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2009GL038401">Michelangeli <em>et al.</em>, 2009</a>). </p><p>Let <span>$F_X$</span> be the actual cumulative distribution function (cdf) and <span>$F_Y$</span> be the target cdf. Let <span>$x$</span> be a realization of <span>$F_X$</span>. The basic idea of the QM method is to find the value <span>$\tilde{x}$</span> such that</p><p class="math-container">\[F_Y(\tilde{x}) = F_X(x).\]</p><p>Therefore,</p><p class="math-container">\[\tilde{x} = F_Y^{-1} \left\lbrace F_X(x) \right\rbrace.\]</p><p>The package also provides functions for the CDF-t approach (Michelangeli <em>et al.</em>, 2009) which extends the quantile matching framework to the non-stationary context. Let <span>$F_{X^\prime}$</span> be the projected cdf with respect to <span>$F_X$</span>. The CDF-t approach defines the projected target cdf <span>$F_{Y^\prime}$</span> as follows:</p><p class="math-container">\[F_{Y^\prime}(x) = F_Y \left[ F_X^{-1} \left\lbrace F_{X^\prime}(x) \right\rbrace \right].\]</p><p>If <span>$x$</span> is a realization of the projected cdf <span>$F_{X^\prime}$</span>, then the corresponding value <span>$\tilde{x}$</span> with respect to <span>$F_{Y^\prime}$</span> is as follows:</p><p class="math-container">\[\tilde{x} = F_{Y^\prime}^{-1} \left\lbrace F_{X^\prime}(x) \right\rbrace.\]</p><h2 id="Package-interface"><a class="docs-heading-anchor" href="#Package-interface">Package interface</a><a id="Package-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Package-interface" title="Permalink"></a></h2><p>To perform quantile matching, the model has to be defined in a <a href="../#QuantileMatching.AbstractQuantileMatchingModel"><code>AbstractQuantileMatchingModel</code></a> and the method <a href="../#Base.match"><code>match</code></a> can be applied to correct the given values. </p><p>If the cdfs are known, the <a href="../#QuantileMatching.ParametricQuantileMatchingModel"><code>ParametricQuantileMatchingModel</code></a> structure can be defined and the <a href="../#Base.match"><code>match</code></a> method can be applied to it to perform quantile matching. In practice, the cdfs are generally unknown. They can be estimated either non-parametrically using the empirical distribution function or using a parametric estimate. The first approach is known as empirical quantile matching and the second as parametric quantile matching. The parametric estimates can be used to define the <a href="../#QuantileMatching.ParametricQuantileMatchingModel"><code>ParametricQuantileMatchingModel</code></a> structure. </p><p>Turnkey solutions are also provided to automatically perform quantile matching from random samples of different distributions. See for example <code>eqm</code> and <code>pqm</code>. More details are available in the Example.</p><h2 id="Empirical-Quantile-Matching"><a class="docs-heading-anchor" href="#Empirical-Quantile-Matching">Empirical Quantile Matching</a><a id="Empirical-Quantile-Matching-1"></a><a class="docs-heading-anchor-permalink" href="#Empirical-Quantile-Matching" title="Permalink"></a></h2><p>For empirical quantile matching, the <a href="../#QuantileMatching.EmpiricalQuantileMatchingModel"><code>EmpiricalQuantileMatchingModel</code></a> structure can be defined using</p><ul><li>a sample of the target distribution; </li><li>a sample of the actual distribution;</li><li>a sample of the projected distribution. </li></ul><p>If the sample of the projected distribution is omitted, the matching method is stationary. Once the model is defined, the <a href="../#Base.match"><code>match</code></a> method can be called to perform the matching.</p><h2 id="Parametric-Quantile-Matching"><a class="docs-heading-anchor" href="#Parametric-Quantile-Matching">Parametric Quantile Matching</a><a id="Parametric-Quantile-Matching-1"></a><a class="docs-heading-anchor-permalink" href="#Parametric-Quantile-Matching" title="Permalink"></a></h2><p>For parametric quantile matching, the <a href="../#QuantileMatching.ParametricQuantileMatchingModel"><code>ParametricQuantileMatchingModel</code></a> structure can be defined using</p><ul><li>the target distribution; </li><li>the actual distribution;</li><li>the projected distribution. </li></ul><p>Those distributions should be in the class of <code>UnivariateContinuousDistribution</code> of the Julia package <a href="https://juliastats.org/Distributions.jl/stable/">Distributions.jl</a>. If the projected distribution is omitted, the matching method is stationary. Once the model is defined, the <a href="../#Base.match"><code>match</code></a> method can be called to perform the matching.</p><h2 id="Frequency-adjustment"><a class="docs-heading-anchor" href="#Frequency-adjustment">Frequency adjustment</a><a id="Frequency-adjustment-1"></a><a class="docs-heading-anchor-permalink" href="#Frequency-adjustment" title="Permalink"></a></h2><p>When working with a distribution having a mass at some point, such as 0 for precipitation, Themeßl <em>et al.</em> (2011) propose to censor the value of the realization <span>$x^\star$</span> of the actual cdf as follows:</p><p class="math-container">\[    x = \begin{cases}
        0 &amp; \text{ if } x^\star_i \leq u ;\\
        x^\star_i - u &amp; \text{ if } x^\star_i &gt; u.
        \end{cases}\]</p><p>where <span>$u$</span> is the threshold for which the probability that <span>$X$</span> exceeds <span>$u$</span> is equal to the probability that <span>$Y$</span> exceeds 0. Quantile matching can then be performed on the censored values. The frequency adjustment can be performed using the following functions:</p><ul><li><a href="../#QuantileMatching.censor-Tuple{Vector{&lt;:Real}, Real}"><code>censor</code></a>;</li><li><a href="../#QuantileMatching.wet_threshold-Tuple{AbstractVector{&lt;:Real}, Real}"><code>wet_threshold</code></a>;</li><li><a href="../#QuantileMatching.pwet"><code>pwet</code></a>.</li></ul><p>More details are available in the Example.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The library was developed with the idea of post-processing the outputs of numerical climate models. This is why several functions use terminology associated with climate sciences. The functions are however general enough to be applied to other contexts. For example, censoring can be done for a threshold different from 0.</p></div></div><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>Michelangeli, P.-A., Vrac, M., and Loukos, H. (2009), Probabilistic downscaling approaches:  Application to wind cumulative distribution functions, <em>Geophys. Res. Lett.</em>, 36, L11708, doi:10.1029/2009GL038401.</p><p>Panofsky, H. and Brier, G. (1968). Some Applications of Statistics to Meteorology, Earth and Mineral Sciences Continuing Education, College of Earth and Mineral Sciences, The Pennsylvania State University.</p><p>Themeßl, M., Gobiet, A. and Leuprecht, A. (2011). Empirical-statistical downscaling and error correction of daily precipitation from regional climate models, <em>International Journal of Climatology</em>, 31, 1530–1544, https://doi.org/https://doi.org/10.1002/joc.2168.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="../StationaryQuantileMatching/">Stationary Quantile Matching »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 25 May 2023 03:12">Thursday 25 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
